#N canvas 360 60 793 633 10;
#X obj 445 52 array define \$0-env 515;
#N canvas 0 22 450 300 gen_array 0;
#N canvas 0 22 450 300 counter 0;
#X obj 66 121 until;
#X obj 66 96 f 512;
#X obj 66 146 f 0, f 8;
#X obj 146 146 + 1;
#X obj 66 46 inlet;
#X obj 66 71 t b b, f 8;
#X obj 127 96 f 0;
#X obj 66 171 outlet;
#X connect 0 0 2 0;
#X connect 1 0 0 0;
#X connect 2 0 3 0;
#X connect 2 0 7 0;
#X connect 3 0 2 1;
#X connect 4 0 5 0;
#X connect 5 0 1 0;
#X connect 5 1 6 0;
#X connect 6 0 2 1;
#X restore 48 86 pd counter;
#X obj 48 190 array set \$0-env, f 28;
#X obj 48 111 t f f, f 14;
#X obj 130 158 + 1;
#N canvas 0 22 450 300 mapcos 0;
#X obj 79 81 * 6.28319;
#X obj 79 106 - 3.14159;
#X obj 79 159 + 1;
#X obj 79 182 * 0.5;
#X obj 79 134 cos;
#X obj 79 27 inlet;
#X obj 79 207 outlet;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 2 0 3 0;
#X connect 3 0 6 0;
#X connect 4 0 2 0;
#X connect 5 0 0 0;
#X restore 48 158 pd mapcos;
#X obj 48 133 / 512;
#X msg 48 62 512;
#X obj 48 36 loadbang;
#X connect 0 0 2 0;
#X connect 2 0 5 0;
#X connect 2 1 3 0;
#X connect 3 0 1 1;
#X connect 4 0 1 0;
#X connect 5 0 4 0;
#X connect 6 0 0 0;
#X connect 7 0 6 0;
#X restore 445 28 pd gen_array;
#X obj 36 272 *~ 512;
#X obj 36 294 +~ 1;
#X obj 149 219 +~ 0.5;
#X obj 149 241 wrap~;
#X obj 149 272 *~ 512;
#X obj 149 294 +~ 1;
#X obj 36 317 tabread4~ \$0-env;
#X obj 149 317 tabread4~ \$0-env;
#X obj 36 539 *~;
#X obj 149 539 *~;
#X text 444 10 Envelope generator;
#X obj 164 497 vd~ \$1;
#X obj 51 497 vd~ \$1;
#X obj 89 592 outlet~ pitched signal;
#X obj 72 366 r \$0-winsize;
#X obj 185 366 r \$0-winsize;
#X obj 141 54 r \$0-freq;
#X obj 102 97 *~ 1, f 7;
#X obj 164 458 +~ 1.5;
#X obj 51 458 +~ 1.5;
#X obj 141 76 * -1;
#X obj 102 52 -~ 1;
#X text 241 81 f is one minus the delay time increment in samples.
, f 32;
#X obj 102 30 inlet~ factor;
#X text 241 109 f = 1 -> Original pitch, f 32;
#X text 241 119 f = 2 -> One octave above, f 32;
#X text 241 129 f = 0.5 -> One octave below, f 32;
#N canvas 172 157 450 300 cent_to_factor 0;
#X obj 119 43 nbx 5 14 -1e+37 1e+37 0 0 empty empty empty 0 -8 0 10
-262144 -1 -1 0 256;
#X text 175 43 cent;
#X obj 119 152 pow, f 5;
#X obj 119 62 t b f, f 13;
#X obj 119 106 f 2;
#X obj 119 84 t b b;
#X obj 146 106 f 1;
#X obj 146 128 / 12;
#X obj 119 182 pow, f 13;
#X obj 119 204 nbx 5 14 -1e+37 1e+37 0 0 empty empty empty 0 -8 0 10
-262144 -1 -1 0 256;
#X text 176 203 factor;
#X connect 0 0 3 0;
#X connect 2 0 8 0;
#X connect 3 0 5 0;
#X connect 3 1 8 1;
#X connect 4 0 2 0;
#X connect 5 0 4 0;
#X connect 5 1 6 0;
#X connect 6 0 7 0;
#X connect 7 0 2 1;
#X connect 8 0 9 0;
#X restore 443 125 pd cent_to_factor;
#X text 441 79 Conversion from cent (1/100th of semitone) to factor
is (2^1/12)^cent, f 32;
#X text 206 457 Adds a small delay time offset.;
#X text 309 360 Multiplies the sawtooth by the window size to convert
it into a delay time., f 40;
#X text 241 27 Converts pitch shifting factor f to phasor frequency
-(f-1) * (1000/window size)., f 32;
#X text 193 223 Inverts the phase of the sawtooth., f 17;
#X text 192 277 Converts the sawtooth into buffer indices., f 27;
#X text 154 163 Generates the sawtooth that control the readings of
the envelope and the variations of the delay times., f 37;
#X text 252 310 Reads the envelope (one with inverted phase)., f 23
;
#X text 309 390 When the frequency is different from zero \, the delay
time increases from zero to the window size or decreases from the window
size to zero., f 41;
#X text 209 496 Reads the delay buffer., f 27;
#X text 177 528 Applies the windowing to avoid the click when the delay
time jumps from the window size to zero when phasor frequency is positive
or inversely when the delay time jumps from zero to the window size
when the phasor frequency is negative.;
#X obj 629 358 t b f, f 8;
#X obj 629 380 f 1000;
#X obj 629 402 /, f 8;
#X obj 572 240 loadbang;
#X obj 572 262 f \$2;
#X obj 629 428 s \$0-freq;
#X text 694 373 Converts the window size to a frequency., f 14;
#X text 606 263 Window size;
#X obj 572 284 moses 0.02;
#X obj 572 306 t f b;
#X obj 599 329 f 0.02;
#X text 16 3 Double Read Head For Pitch Shifting Variable Delay;
#X obj 102 170 phasor~;
#X obj 691 419 s \$0-winsize;
#X obj 572 453 print delpitch~ - The window size must be superior or
equal to 0.02, f 19;
#X obj 164 391 *~ 1;
#X obj 51 391 *~ 1;
#X connect 2 0 3 0;
#X connect 3 0 8 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 5 0 56 0;
#X connect 6 0 7 0;
#X connect 7 0 9 0;
#X connect 8 0 10 0;
#X connect 9 0 11 0;
#X connect 10 0 15 0;
#X connect 11 0 15 0;
#X connect 13 0 11 1;
#X connect 14 0 10 1;
#X connect 16 0 57 1;
#X connect 17 0 56 1;
#X connect 18 0 22 0;
#X connect 19 0 53 0;
#X connect 20 0 13 0;
#X connect 21 0 14 0;
#X connect 22 0 19 1;
#X connect 23 0 19 0;
#X connect 25 0 23 0;
#X connect 41 0 42 0;
#X connect 41 1 43 1;
#X connect 41 1 54 0;
#X connect 42 0 43 0;
#X connect 43 0 46 0;
#X connect 44 0 45 0;
#X connect 45 0 49 0;
#X connect 49 0 50 0;
#X connect 49 1 41 0;
#X connect 50 0 55 0;
#X connect 50 1 51 0;
#X connect 51 0 41 0;
#X connect 53 0 2 0;
#X connect 53 0 4 0;
#X connect 53 0 57 0;
#X connect 56 0 20 0;
#X connect 57 0 21 0;
